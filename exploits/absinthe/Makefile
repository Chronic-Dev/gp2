NAME=absinthe
ETCFLAGS=../../libs/osx/libimobiledevice.a ../../libs/osx/libplist.a ../../libs/osx/libusbmuxd.a
CC=gcc
CFLAGS=-m32 -w -I../../includes/ -I. -g -D_FILE_OFFSET_BITS=64 -D_LARGE_FILES -fPIC -arch i386  -g -O2 -static-libgcc -arch i386
LDFLAGS=-lpthread -lz -lm -liconv -lssl -lcrypto -lxml2 -dynamiclib -install_name $(NAME) -o ../$(NAME).dylib $(ETCFLAGS)
OBJECTS=absinthe.o afc.o architecture.o backup.o backup_file.o common.o \
crashreport.o crashreportcopy.o crashreporter.o crashreportmover.o \
device.o dictionary.o dyldcache.o dyldimage.o dyldmap.o file.o fsgen.o \
idevicebackup2.o idevicepair.o jailbreak.o lockdown.o macho.o \
macho_command.o macho_section.o macho_segment.o macho_symbol.o \
macho_symtab.o mb1.o mb2.o mb2insert.o mbdb.o mbdb_record.o \
plist_extras.o rop.o template.o

%.o: %.c
	@$(CC) -c $(<) -o $(@) $(CFLAGS)

all: $(OBJECTS)
	@$(CC) $(CFLAGS) $(LDFLAGS)

clean:
	@rm *.o
