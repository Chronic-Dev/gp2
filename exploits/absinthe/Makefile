NAME=absinthe
ETCFLAGS=../../libs/osx/libimobiledevice.a ../../libs/osx/libplist.a ../../libs/osx/libusbmuxd.a ../../libs/osx/libgnutls.a ../../libs/osx/libgcrypt.a ../../libs/osx/libgpg-error.a
CC=gcc
CFLAGS=-m32 -w -I../../includes/ -I. -g -D_FILE_OFFSET_BITS=64 -D_LARGE_FILES -fPIC -arch i386  -g -O2 -static-libgcc -arch i386
LDFLAGS=-lpthread -lz -lm -liconv -lssl -lcrypto -lxml2 -dynamiclib -install_name $(NAME) -o ../$(NAME).dylib $(ETCFLAGS)
OBJECTS = absinthe.o jailbreak.o common.o file.o backup.o backup_file.o mbdb.o mbdb_record.o device.o lockdown.o mb1.o plist_extras.o crashreporter.o crashreportmover.o crashreportcopy.o crashreport.o dictionary.o dyldcache.o dyldimage.o dyldmap.o macho.o macho_segment.o macho_symtab.o macho_section.o macho_command.o architecture.o idevicebackup2.o fsgen.o

%.o: %.c
	$(CC) -c $(<) -o $(@) $(CFLAGS)

all: $(OBJECTS)
	$(CC) $(CFLAGS) $(LDFLAGS) $(OBJECTS)

clean:
	@rm *.o
